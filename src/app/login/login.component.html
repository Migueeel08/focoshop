<div class="login-container">
  <!-- üîπ ALERTA MODAL CENTRADO -->
  <div *ngIf="alertaVisible" class="alerta-modal" (click)="cerrarAlerta()">
    <div class="alerta-card" [ngClass]="tipoAlerta" (click)="$event.stopPropagation()">
      <div class="alerta-icon">
        <i [class]="tipoAlerta === 'exito' ? 'fas fa-check-circle' : tipoAlerta === 'error' ? 'fas fa-times-circle' : 'fas fa-info-circle'"></i>
      </div>
      <h3>{{ mensajeAlerta }}</h3>
      <button class="btn-cerrar-alerta" (click)="cerrarAlerta()">
        <i class="fas fa-times"></i>
      </button>
    </div>
  </div>

  <!-- CONTENEDOR CON DOS COLUMNAS -->
  <div class="login-wrapper">
    
    <!-- COLUMNA IZQUIERDA: FORMULARIO -->
    <div class="login-card">
      <!-- LOGO -->
      <div class="logo-section">
        <div class="logo-icon">
          <i class="fas fa-shopping-cart"></i>
        </div>
        <div class="logo-info">
          <h1 class="logo-text">FOCOSHOP</h1>
          <p class="logo-subtitle">Tu tienda favorita</p>
        </div>
      </div>

      <!-- TABS DE LOGIN Y REGISTRO -->
      <div class="tabs">
        <button 
          class="tab" 
          [class.active]="!isRegisterMode"
          (click)="switchToLogin()"
          type="button">
          <i class="fas fa-sign-in-alt"></i>
          Iniciar Sesi√≥n
        </button>
        <button 
          class="tab" 
          [class.active]="isRegisterMode"
          (click)="switchToRegister()"
          type="button">
          <i class="fas fa-user-plus"></i>
          Registrarse
        </button>
      </div>

      <!-- ‚úÖ BOT√ìN DE GOOGLE (Solo en modo Login) -->
      <div *ngIf="!isRegisterMode" class="google-section">
        <div id="buttonDiv"></div>
        <div class="divider">
          <span>O contin√∫a con email</span>
        </div>
      </div>

      <!-- FORMULARIO -->
      <form (ngSubmit)="onSubmit()" #loginForm="ngForm">
        
        <!-- ===== CAMPOS DE REGISTRO ===== -->
        <div *ngIf="isRegisterMode" class="input-row">
          <!-- Nombre -->
          <div class="input-group half">
            <label>
              <i class="fas fa-user"></i>
              Nombre
            </label>
            <input 
              type="text" 
              [(ngModel)]="nombre" 
              name="nombre" 
              placeholder="Juan"
              [class.error]="nombreInvalido"
              (blur)="validarNombre()"
              required 
            />
            <span *ngIf="nombreInvalido" class="error-message">
              <i class="fas fa-exclamation-circle"></i>
              El nombre es obligatorio
            </span>
          </div>

          <!-- Apellido -->
          <div class="input-group half">
            <label>
              <i class="fas fa-user"></i>
              Apellido
            </label>
            <input 
              type="text" 
              [(ngModel)]="apellido" 
              name="apellido" 
              placeholder="P√©rez"
              [class.error]="apellidoInvalido"
              (blur)="validarApellido()"
              required 
            />
            <span *ngIf="apellidoInvalido" class="error-message">
              <i class="fas fa-exclamation-circle"></i>
              El apellido es obligatorio
            </span>
          </div>
        </div>

        <!-- Correo electr√≥nico -->
        <div class="input-group">
          <label>
            <i class="fas fa-envelope"></i>
            Correo Electr√≥nico
          </label>
          <input 
            type="email" 
            [(ngModel)]="email" 
            name="email" 
            placeholder="ejemplo@correo.com"
            [class.error]="emailInvalido"
            [class.success]="emailValido"
            (input)="validarEmail()"
            (blur)="validarEmail()"
            required 
          />
          <span *ngIf="emailInvalido" class="error-message">
            <i class="fas fa-exclamation-circle"></i>
            {{ emailMensaje }}
          </span>
          <span *ngIf="emailValido && email" class="success-message">
            <i class="fas fa-check-circle"></i>
            Email v√°lido
          </span>
        </div>

        <!-- Contrase√±a -->
        <div class="input-group">
          <label>
            <i class="fas fa-lock"></i>
            Contrase√±a
          </label>
          <div class="password-wrapper">
            <input 
              [type]="mostrarContrasena ? 'text' : 'password'" 
              [(ngModel)]="contrasena" 
              name="contrasena" 
              placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
              [class.error]="contrasenaInvalida"
              [class.success]="contrasenaValida"
              (input)="validarContrasena()"
              (blur)="validarContrasena()"
              required 
            />
            <button 
              type="button" 
              class="btn-toggle-password" 
              (click)="toggleMostrarContrasena()"
              tabindex="-1"
            >
              <i [class]="mostrarContrasena ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
            </button>
          </div>

          <!-- BARRA DE SEGURIDAD (Solo en registro) -->
          <div *ngIf="isRegisterMode && contrasena" class="password-strength">
            <div class="strength-bar">
              <div 
                class="strength-fill" 
                [style.width.%]="fuerzaContrasena"
                [class.weak]="nivelSeguridad === 'd√©bil'"
                [class.medium]="nivelSeguridad === 'media'"
                [class.strong]="nivelSeguridad === 'fuerte'"
              ></div>
            </div>
            <div class="strength-text">
              <span 
                [class.weak]="nivelSeguridad === 'd√©bil'"
                [class.medium]="nivelSeguridad === 'media'"
                [class.strong]="nivelSeguridad === 'fuerte'"
              >
                <i 
                  [class]="nivelSeguridad === 'd√©bil' ? 'fas fa-exclamation-triangle' : 
                           nivelSeguridad === 'media' ? 'fas fa-shield-alt' : 
                           'fas fa-shield-virus'"
                ></i>
                Seguridad: {{ nivelSeguridad }}
              </span>
            </div>
          </div>

          <!-- Requisitos de contrase√±a (Solo en registro) -->
          <div *ngIf="isRegisterMode && contrasena" class="password-requirements">
            <div class="requirement" [class.met]="requisitos.longitud">
              <i [class]="requisitos.longitud ? 'fas fa-check-circle' : 'fas fa-circle'"></i>
              M√≠nimo 8 caracteres
            </div>
            <div class="requirement" [class.met]="requisitos.mayuscula">
              <i [class]="requisitos.mayuscula ? 'fas fa-check-circle' : 'fas fa-circle'"></i>
              Una may√∫scula
            </div>
            <div class="requirement" [class.met]="requisitos.minuscula">
              <i [class]="requisitos.minuscula ? 'fas fa-check-circle' : 'fas fa-circle'"></i>
              Una min√∫scula
            </div>
            <div class="requirement" [class.met]="requisitos.numero">
              <i [class]="requisitos.numero ? 'fas fa-check-circle' : 'fas fa-circle'"></i>
              Un n√∫mero
            </div>
            <div class="requirement" [class.met]="requisitos.especial">
              <i [class]="requisitos.especial ? 'fas fa-check-circle' : 'fas fa-circle'"></i>
              Un car√°cter especial (!&#64;#$%^&*)
            </div>
          </div>

          <span *ngIf="contrasenaInvalida && !isRegisterMode" class="error-message">
            <i class="fas fa-exclamation-circle"></i>
            La contrase√±a debe tener al menos 6 caracteres
          </span>
        </div>

        <!-- Confirmar contrase√±a (Solo en registro) -->
        <div *ngIf="isRegisterMode" class="input-group">
          <label>
            <i class="fas fa-lock"></i>
            Confirmar Contrase√±a
          </label>
          <div class="password-wrapper">
            <input 
              [type]="mostrarConfirmarContrasena ? 'text' : 'password'" 
              [(ngModel)]="confirmarContrasena" 
              name="confirmarContrasena" 
              placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
              [class.error]="confirmarContrasenaInvalida"
              [class.success]="confirmarContrasenaValida"
              (input)="validarConfirmarContrasena()"
              (blur)="validarConfirmarContrasena()"
              required 
            />
            <button 
              type="button" 
              class="btn-toggle-password" 
              (click)="toggleMostrarConfirmarContrasena()"
              tabindex="-1"
            >
              <i [class]="mostrarConfirmarContrasena ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
            </button>
          </div>
          <span *ngIf="confirmarContrasenaInvalida" class="error-message">
            <i class="fas fa-exclamation-circle"></i>
            Las contrase√±as no coinciden
          </span>
          <span *ngIf="confirmarContrasenaValida && confirmarContrasena" class="success-message">
            <i class="fas fa-check-circle"></i>
            Las contrase√±as coinciden
          </span>
        </div>

        <!-- Recordarme (Solo en login) -->
        <div *ngIf="!isRegisterMode" class="options-row">
          <label class="checkbox-container">
            <input type="checkbox" [(ngModel)]="recordarme" name="recordarme" />
            <span class="checkmark"></span>
            Recordarme
          </label>
          <a class="forgot-password">¬øOlvidaste tu contrase√±a?</a>
        </div>

        <!-- BOT√ìN PRINCIPAL -->
        <button 
          type="submit" 
          class="btn-login"
          [disabled]="!formularioValido()"
          [class.disabled]="!formularioValido()"
        >
          <span *ngIf="!cargando">
            {{ isRegisterMode ? 'CREAR CUENTA' : 'INICIAR SESI√ìN' }}
          </span>
          <span *ngIf="cargando" class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i>
            Procesando...
          </span>
          <i *ngIf="!cargando" class="fas fa-arrow-right"></i>
        </button>
      </form>

      <!-- DIVIDER Y GOOGLE (Solo en modo Registro) -->
      <div *ngIf="isRegisterMode">
        <div class="divider">
          <span>O</span>
        </div>

        <!-- BOT√ìN DE GOOGLE MANUAL (para registro) -->
        <button class="btn-google" type="button" (click)="switchToLogin()">
          <i class="fab fa-google"></i>
          Registrarse con Google
        </button>
      </div>

      <!-- Footer -->
      <div class="form-footer">
        <p *ngIf="!isRegisterMode">
          ¬øNo tienes cuenta? 
          <a (click)="switchToRegister()">Reg√≠strate aqu√≠</a>
        </p>
        <p *ngIf="isRegisterMode">
          ¬øYa tienes cuenta? 
          <a (click)="switchToLogin()">Inicia sesi√≥n aqu√≠</a>
        </p>
      </div>
    </div>

    <!-- COLUMNA DERECHA: ILUSTRACI√ìN -->
    <div class="illustration-section">
      <div class="illustration-content">
        <div class="welcome-text">
          <h2 *ngIf="!isRegisterMode">¬°Bienvenido de vuelta!</h2>
          <h2 *ngIf="isRegisterMode">¬°√önete a nosotros!</h2>
          <p *ngIf="!isRegisterMode">Inicia sesi√≥n para continuar con tus compras</p>
          <p *ngIf="isRegisterMode">Crea tu cuenta y descubre incre√≠bles ofertas</p>
        </div>
        <img src="assets/img/delivery-character.png" alt="Delivery" class="character-img" />
        
        <!-- Caracter√≠sticas -->
        <div class="features">
          <div class="feature">
            <i class="fas fa-shipping-fast"></i>
            <span>Env√≠o r√°pido</span>
          </div>
          <div class="feature">
            <i class="fas fa-shield-alt"></i>
            <span>Compra segura</span>
          </div>
          <div class="feature">
            <i class="fas fa-percent"></i>
            <span>Mejores precios</span>
          </div>
        </div>

        <!-- Iconos flotantes -->
        <div class="floating-icons">
          <div class="icon-float" style="--delay: 0s; --x: 10%; --y: 20%;">
            <i class="fas fa-shopping-bag"></i>
          </div>
          <div class="icon-float" style="--delay: 1s; --x: 80%; --y: 15%;">
            <i class="fas fa-gift"></i>
          </div>
          <div class="icon-float" style="--delay: 2s; --x: 15%; --y: 75%;">
            <i class="fas fa-star"></i>
          </div>
          <div class="icon-float" style="--delay: 1.5s; --x: 85%; --y: 70%;">
            <i class="fas fa-heart"></i>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>